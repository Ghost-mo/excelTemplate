# excelTemplate
Формирование отчетов по excell шаблону.
(report generation by template).
Если интересно напишите, обновлю.

В DataSet прописан Dictionary<string,string> values

Данные из Оракл выгружаются таблицами table1, table2 в DataSet.

Значения переменных для шаблон хранятся в Dictionary<string,string> values

В Шаблоне:

В графиках использовать ссылку на ряды (именованный диапазон)

${graf} – расположение графика

${имяПеременной}

${Таблица.колонка}

Формулы надо писать на английском языке

$[AVR(Диапазон)] –это формула

$[SUM(B@;D@:G@)]
@-номер строки

Поддерживается функция подитогов, но не более 9 уровней без учета общего итога:

<sub> -- обозначает, что дальше пойдут данные по которым будут подводить под итог
 
<subitog1:Таблица.колонка>Текст – обозначает под итог, цифра после subitog обозначает кол-во промежуточных подитогов, после : указывается по изменениям какой колонки будут подводиться итоги. Текст просто текст в ячейке.

<subitogFull>Текст – обозначает подведение общего итога. Текст просто текст в ячейке.
 
В строке subitog там где нужны итоги необходимо писать формат итога.

Пример:

<sub>${res.PARTICIPANT_NAME}	${res.pf_code}	${res.DEP_MARGA_INCOME}
 
<subitog1:res. pf_code >Итого	 	<SUM>
 
<subitog1:res.PARTICIPANT_NAME>Итого	 	<SUM>
 	 	 
<subitogFull>Итого по разделу 1	<SUM>

пример лучше смотреть в примерах excel
